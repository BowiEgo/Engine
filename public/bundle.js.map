{"version":3,"file":"bundle.js","sources":["../src/core/Camera.js","../src/core/Time.js","../src/core/Mouse.js","../src/core/Scene.js","../src/core/Render.js","../src/core/Engine.js","../src/utils/index.js","../src/core/Object.js","../src/core/Input.js","../src/geometry/Vertices.js","../src/geometry/Projection.js","../src/collision/SAT.js","../src/shape/Shape.js","../src/geometry/Vector.js","../src/shape/Polygon.js","../src/shape/Circle.js","../src/shape/Rectangle.js","../src/main.js"],"sourcesContent":["let Camera = {};\n\nCamera.create = (game) => {\n  let camera = {};\n  camera.position = { x: 0, y: 0 };\n  camera.offset = { x: 0, y: 0 };\n  camera.scale = 1;\n  camera.lookAt = null;\n\n  let isDragging = false;\n  let lastMousePosition = { x: 0, y: 0 };\n\n  game.mouse.on('mousemove', mouse => {\n    if (isDragging) {\n      camera.offset = subPos(mouse.position, lastMousePosition);\n      camera.position = addPos(camera.position, camera.offset);\n      lastMousePosition.x = mouse.position.x;\n      lastMousePosition.y = mouse.position.y;\n      game.render.clear(camera.scale);\n      game.render.context.translate(camera.offset.x, camera.offset.y);\n    }\n  });\n\n  game.mouse.on('mouseout', mouse => {\n    isDragging = false;\n  });\n\n  game.mouse.on('mousedown', mouse => {\n    isDragging = true;\n    lastMousePosition.x = mouse.mousedownPosition.x;\n    lastMousePosition.y = mouse.mousedownPosition.y;\n  });\n\n  game.mouse.on('mouseup', mouse => {\n    camera.offset = { x: 0, y: 0 };\n    isDragging = false;\n  });\n\n  game.mouse.on('mousewheel', mouse => {\n    let deltaScale = 1 + mouse.wheelDelta * 0.008;\n    camera.scale *= deltaScale;\n    game.render.clear(camera.scale);\n    game.render.context.scale(deltaScale, deltaScale);\n  });\n\n  return camera;\n}\n\nCamera.lookAt = () => {\n}\n\nCamera.follow = () => {\n}\n\nfunction addPos (posA, posB) {\n  return {\n    x: posA.x + posB.x,\n    y: posA.y + posB.y \n  }\n}\n\nfunction subPos (posA, posB) {\n  return {\n    x: posA.x - posB.x,\n    y: posA.y - posB.y \n  }\n}\n\nexport default Camera\n","const STARTING_FPS = 60;\n\nlet Time = {\n  timeScale: 0,\n  unscaledDeltaTime: 0,\n  deltaTime: 0\n};\n\nTime.reset = () => {\n  Time.timeStart = 0;\n  Time.timePassed = 0;\n  Time.fps = STARTING_FPS;\n}\n\nTime.update = (timeStamp) => {\n  if (Time.timeStart === 0) {\n    Time.timeStart = timeStamp;\n    Time.fps = STARTING_FPS;\n  } else {\n    Time.fps = 1000 / (timeStamp - Time.timeStart);\n  }\n\n  Time.unscaledDeltaTime = 1 / Time.fps;\n  Time.deltaTime = Time.unscaledDeltaTime * Time.timeScale;\n\n  Time.timePassed += Time.unscaledDeltaTime;\n  Time.timeStart = timeStamp;\n}\n\nTime.reset();\n\nexport default Time\n","let Mouse = {};\n\nMouse.create = (element) => {\n  let mouse = {};\n\n  mouse.element = element;\n  mouse.absolute = { x: 0, y: 0 };\n  mouse.position = { x: 0, y: 0 };\n  mouse.mousedownPosition = { x: 0, y: 0 };\n  mouse.mouseupPosition = { x: 0, y: 0 };\n  mouse.offset = { x: 0, y: 0 };\n  mouse.scale = { x: 1, y: 1 };\n  mouse.wheelDelta = 0;\n  mouse.button = -1;\n  mouse.pixelRatio = parseInt(mouse.element.getAttribute('data-pixel-ratio'), 10) || 1;\n\n  mouse.sourceEvents = {\n    mousemove: null,\n    mouseout: null,\n    mousedown: null,\n    mouseup: null,\n    mousewheel: null\n  };\n\n  mouse.eventHooks = {\n    mousemove: null,\n    mouseout: null,\n    mousedown: null,\n    mouseup: null,\n    mousewheel: null\n  }\n\n  mouse.on = function (eventName, callback) {\n    mouse.eventHooks[eventName] = callback;\n  }\n\n  mouse.triggerHook = function (eventName) {\n    mouse.eventHooks[eventName].call(null, mouse);\n  }\n\n  mouse.mousemove = function (event) {\n    let position = Mouse._getRelativeMousePosition(event, mouse.element, mouse.pixelRatio),\n      touches = event.changedTouches;\n\n    if (touches) {\n      mouse.button = 0;\n      event.preventDefault();\n    }\n\n    mouse.absolute.x = position.x;\n    mouse.absolute.y = position.y;\n    mouse.position.x = mouse.absolute.x * mouse.scale.x + mouse.offset.x;\n    mouse.position.y = mouse.absolute.y * mouse.scale.y + mouse.offset.y;\n    mouse.sourceEvents.mousemove = event;\n\n    mouse.triggerHook('mousemove');\n  }\n\n  mouse.mouseout = function () {\n    mouse.triggerHook('mouseout');\n  }\n\n  mouse.mousedown = function(event) {\n    let position = Mouse._getRelativeMousePosition(event, mouse.element, mouse.pixelRatio),\n      touches = event.changedTouches;\n\n    if (touches) {\n      mouse.button = 0;\n      event.preventDefault();\n    } else {\n      mouse.button = event.button;\n    }\n\n    mouse.absolute.x = position.x;\n    mouse.absolute.y = position.y;\n    mouse.position.x = mouse.absolute.x * mouse.scale.x + mouse.offset.x;\n    mouse.position.y = mouse.absolute.y * mouse.scale.y + mouse.offset.y;\n    mouse.mousedownPosition.x = mouse.position.x;\n    mouse.mousedownPosition.y = mouse.position.y;\n    mouse.sourceEvents.mousedown = event;\n\n    mouse.triggerHook('mousedown');\n  };\n\n  mouse.mouseup = function(event) {\n    let position = Mouse._getRelativeMousePosition(event, mouse.element, mouse.pixelRatio),\n      touches = event.changedTouches;\n\n    if (touches) {\n      event.preventDefault();\n    }\n    \n    mouse.button = -1;\n    mouse.absolute.x = position.x;\n    mouse.absolute.y = position.y;\n    mouse.position.x = mouse.absolute.x * mouse.scale.x + mouse.offset.x;\n    mouse.position.y = mouse.absolute.y * mouse.scale.y + mouse.offset.y;\n    mouse.mouseupPosition.x = mouse.position.x;\n    mouse.mouseupPosition.y = mouse.position.y;\n    mouse.sourceEvents.mouseup = event;\n\n    mouse.triggerHook('mouseup');\n  };\n\n  mouse.mousewheel = function(event) {\n    mouse.wheelDelta = Math.max(-1, Math.min(1, event.wheelDelta || -event.detail));\n    event.preventDefault();\n\n    mouse.triggerHook('mousewheel');\n  };\n\n  Mouse.setElement(mouse, element);\n\n  return mouse;\n};\n\nMouse.setElement = (mouse, element) => {\n  element.addEventListener('mousemove', mouse.mousemove);\n  element.addEventListener('mouseout', mouse.mouseout);\n  element.addEventListener('mousedown', mouse.mousedown);\n  element.addEventListener('mouseup', mouse.mouseup);\n  \n  element.addEventListener('mousewheel', mouse.mousewheel);\n  element.addEventListener('DOMMouseScroll', mouse.mousewheel);\n\n  element.addEventListener('touchmove', mouse.mousemove);\n  element.addEventListener('touchstart', mouse.mousedown);\n  element.addEventListener('touchend', mouse.mouseup);\n};\n\n/**\n * Sets the mouse position offset.\n * @method setOffset\n * @param {mouse} mouse\n * @param {vector} offset\n */\nMouse.setOffset = function(mouse, offset) {\n  mouse.offset.x = offset.x;\n  mouse.offset.y = offset.y;\n  mouse.position.x = mouse.absolute.x * mouse.scale.x + mouse.offset.x;\n  mouse.position.y = mouse.absolute.y * mouse.scale.y + mouse.offset.y;\n};\n\n/**\n * Sets the mouse position scale.\n * @method setScale\n * @param {mouse} mouse\n * @param {vector} scale\n */\nMouse.setScale = function(mouse, scale) {\n  mouse.scale.x = scale.x;\n  mouse.scale.y = scale.y;\n  mouse.position.x = mouse.absolute.x * mouse.scale.x + mouse.offset.x;\n  mouse.position.y = mouse.absolute.y * mouse.scale.y + mouse.offset.y;\n};\n\n/**\n * Gets the mouse position relative to an element given a screen pixel ratio.\n * @method _getRelativeMousePosition\n * @private\n * @param {} event\n * @param {} element\n * @param {number} pixelRatio\n * @return {}\n */\nMouse._getRelativeMousePosition = function(event, element, pixelRatio) {\n  let elementBounds = element.getBoundingClientRect(),\n    rootNode = (document.documentElement || document.body.parentNode || document.body),\n    scrollX = (window.pageXOffset !== undefined) ? window.pageXOffset : rootNode.scrollLeft,\n    scrollY = (window.pageYOffset !== undefined) ? window.pageYOffset : rootNode.scrollTop,\n    touches = event.changedTouches,\n    x, y;\n  \n  if (touches) {\n    x = touches[0].pageX - elementBounds.left - scrollX;\n    y = touches[0].pageY - elementBounds.top - scrollY;\n  } else {\n    x = event.pageX - elementBounds.left - scrollX;\n    y = event.pageY - elementBounds.top - scrollY;\n  }\n\n  return { \n    x: x / (element.clientWidth / (element.width || element.clientWidth) * pixelRatio),\n    y: y / (element.clientHeight / (element.height || element.clientHeight) * pixelRatio)\n  };\n};\n\nexport default Mouse\n","let Scene = {};\n\nScene.create = (game) => {\n  let scene = {};\n\n  scene.game = game;\n  scene.objectArray = [];\n\n  scene.addObject = (object) => {\n    scene.objectArray.push(object);\n  }\n\n  scene.reset = () => {\n    scene.objectArray.forEach((object) => {\n      object.reset();\n    })\n  }\n\n  scene.update = () => {\n    scene.objectArray.forEach((object) => {\n      if (game.status === 'playing') {\n        object.updateCb.call(object);\n      }\n    })\n  }\n\n  return scene\n}\n\nexport default Scene\n","import Time from './Time';\n\nlet Render = {};\nlet delta = 0;\n\nRender.create = (game, el, opts) => {\n  console.log('render-create', el, opts);\n  let render = {\n    el: el,\n    game: game\n  };\n\n  const { width = 300, height = 300, bgColor = 'aliceblue' } = opts;\n\n  render.width = width;\n  render.height = height;\n  render.canvas = document.createElement('canvas');\n\n  let pixelRatio = opts.pixelRatio || _getPixelRatio(render.canvas);\n  render.canvas.setAttribute('data-pixel-ratio', pixelRatio);\n\n  render.canvas.width = width * pixelRatio;\n  render.canvas.height = height * pixelRatio;\n  render.canvas.style.width = width + 'px';\n  render.canvas.style.height = height + 'px';\n  render.canvas.style.backgroundColor = bgColor;\n  render.el.append(render.canvas);\n\n  render.context = render.canvas.getContext('2d');\n  render.context.scale(pixelRatio, pixelRatio);\n\n  render.clear = () => {\n    const { camera } = render.game;\n\n    render.context.clearRect(-camera.position.x, -camera.position.y, render.canvas.width, render.canvas.height);\n  }\n\n  render.render = () => {\n    const { objectArray } = render.game.scene;\n\n    objectArray.forEach(object => {\n      const shapeType = object.shape.type;\n\n      switch (shapeType) {\n        case 'polygon':\n          renderPolygon(render.context, object.shape);\n          break;\n        case 'rectangle':\n          renderRectangle(render.context, object.shape);\n          break;\n        case 'circle':\n          renderCircle(render.context, object.shape);\n          break;\n        default:\n          break;\n      }\n    })\n\n    renderFPS(render);\n  }\n\n  return render\n}\n\n/**\n * Gets the pixel ratio of the canvas.\n * @method _getPixelRatio\n * @private\n * @param {HTMLElement} canvas\n * @return {Number} pixel ratio\n */\nfunction _getPixelRatio (canvas) {\n  var context = canvas.getContext('2d'),\n    devicePixelRatio = window.devicePixelRatio || 1,\n    backingStorePixelRatio = context.webkitBackingStorePixelRatio || context.mozBackingStorePixelRatio ||\n    context.msBackingStorePixelRatio ||\n    context.oBackingStorePixelRatio ||\n    context.backingStorePixelRatio || 1;\n\n  return devicePixelRatio / backingStorePixelRatio;\n}\n\nfunction renderFPS (render) {\n  const { context } = render;\n  context.font = '18px Arial';\n\n  context.fillStyle = 'green';\n  context.fillText(Time.fps.toFixed(2), 10, 30);\n}\n\nfunction renderPolygon (context, shape) {\n  const { x: posX, y: posY } = shape.transform.position;\n\n  context.beginPath();\n  context.moveTo(shape.vertices[0].x + posX, shape.vertices[0].y + posY);\n  for (let i = 1; i < shape.vertices.length; i++) {\n    context.lineTo(shape.vertices[i].x + posX, shape.vertices[i].y + posY);\n  }\n  context.closePath();\n\n  draw(context, shape);\n}\n\nfunction renderRectangle (context, shape) {\n  const { x: posX, y: posY } = shape.transform.position;\n\n  context.beginPath();\n  context.rect(posX, posY, shape.width, shape.height);\n  context.closePath();\n\n  draw(context, shape);\n}\n\nfunction renderCircle (context, shape) {\n  const { x: posX, y: posY } = shape.transform.position;\n\n  context.beginPath();\n  context.arc(posX, posY, shape.radius, 0, Math.PI * 2, false);\n  context.closePath();\n\n  draw(context, shape);\n}\n\nfunction draw (context, shape) {\n  context.lineWidth = shape.strokeWidth;\n  context.strokeStyle = shape.strokeStyle;\n  context.fillStyle = shape.fillStyle;\n  shape.strokeWidth > 0 && context.stroke();\n  context.fill();\n}\n\nexport default Render;\n","import Camera from './Camera';\nimport Time from './Time';\nimport Mouse from './Mouse';\nimport Scene from './Scene';\nimport Render from './Render';\n\nlet _reqFrame, _cancelFrame, _frameTimeout;\nif (typeof window !== 'undefined') {\n  _reqFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (callback) {\n    var self = this, start, finish;\n\n    _frameTimeout = window.setTimeout(function () {\n      start = +new Date();\n      callback(start);\n      finish = +new Date();\n      self.timeout = 1000 / 60 - (finish - start);\n    }, self.timeout);\n  };\n\n  _cancelFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame || function () {\n    window.clearTimeout(_frameTimeout);\n  };\n}\n\nlet Engine = {};\n\nEngine.create = (el, opts) => {\n  let game = {};\n  game.el = el;\n  game.status = 'stop';\n  game.showFPS = opts.showFPS !== undefined ? opts.showFPS : true;\n  game.PAUSE_TIMEOUT = 100;\n\n  game.render = Render.create(\n    game,\n    el,\n    opts\n  );\n\n  game.mouse = Mouse.create(game.render.canvas);\n\n  game.camera = Camera.create(game);\n\n  game.scene = Scene.create(game);\n\n  game.start = () => {\n    Time.timeScale = 1;\n    Engine.run(game);\n    game.status = 'playing';\n  }\n\n  game.restart = () => {\n    Engine.reset(game);\n    game.start();\n  }\n\n  game.pause = () => {\n    if (game.status === 'playing') {\n      Time.timeScale = 0;\n      game.status = 'paused';\n    }\n  }\n\n  game.resume = () => {\n    if (game.status === 'paused') {\n      Time.timeScale = 1;\n      game.status = 'playing';\n    }\n  }\n\n  game.stop = () => {\n    Engine.reset(game);\n    game.status = 'stop';\n  }\n\n  Engine.reset(game);\n\n  return game;\n}\n\nEngine.reset = (game) => {\n  _cancelFrame(game.frameReq);\n  Time.reset();\n  game.frameReq = null;\n  game.scene.reset();\n  game.render.clear();\n  game.render.render();\n}\n\nEngine.run = (game) => {\n  if (game.frameReq) {\n    game.stop();\n  }\n\n  game.frameReq = _reqFrame((timeStamp) => tick.call(null, timeStamp));\n\n  function tick (timeStamp) {\n    Time.update(timeStamp); // update Time\n    game.scene.update();\n    game.render.clear();\n    game.render.render();\n    game.frameReq = _reqFrame((timeStamp) => tick.call(null, timeStamp));\n  }\n}\n\nexport default Engine\n","/**\n * Returns true if the object is a function.\n * @method isFunction\n * @param {object} obj\n * @return {boolean} True if the object is a function, otherwise false\n */\nexport function isFunction (obj) {\n  return typeof obj === 'function';\n}\n","import { isFunction } from '../utils';\n\nclass Object {\n  constructor (opts) {\n    this.shape = opts.shape;\n    this.fill = opts.fill !== undefined ? opts.fill : '#83cbff';\n    this.startCb = isFunction(opts.start) ? opts.start : this.start;\n    this.updateCb = isFunction(opts.update) ? opts.update : this.update;\n    this.transform0 = {\n      position: {\n        x: opts.transform.position.x || 0,\n        y: opts.transform.position.y || 0\n      }\n    }\n\n    this.reset();\n  }\n\n  start () {\n  }\n\n  update () {\n  }\n\n  reset () {\n    this.shape.transform = this.transform = JSON.parse(JSON.stringify(this.transform0));\n  }\n\n  render () {\n    const { context } = this.Scene;\n    const { position } = this.transform;\n    const rectW = 40;\n    const rectH = 40;\n\n    context.fillStyle = this.fill;\n    context.fillRect(position.x, position.y, rectW, rectH);\n  }\n}\n\nexport default Object\n","let Input = {\n  keyCodeArray: []\n};\n\nInput.create = () => {\n  document.onkeydown = (event) => {\n    const { keyCode } = event;\n    let idx = Input.keyCodeArray.indexOf(keyCode);\n\n    if (idx === -1) {\n      Input.keyCodeArray.push(keyCode);\n    }\n  }\n\n  document.onkeyup = (event) => {\n    const { keyCode } = event;\n    let idx = Input.keyCodeArray.indexOf(keyCode);\n    if (idx > -1) {\n      Input.keyCodeArray.splice(idx, 1);\n    }\n  }\n}\n\nInput.getAxis = (direction) => {\n  if (direction === 'horizontal') {\n    if (Input.keyCodeArray.indexOf(37) > -1) {\n      return -1\n    }\n    if (Input.keyCodeArray.indexOf(39) > -1) {\n      return 1\n    }\n    return 0\n  }\n\n  if (direction === 'vertical') {\n    if (Input.keyCodeArray.indexOf(38) > -1) {\n      return -1\n    }\n    if (Input.keyCodeArray.indexOf(40) > -1) {\n      return 1\n    }\n    return 0\n  }\n}\n\nInput.create();\n\n// class Input {\n//   constructor () {\n//     this.keyCodeArray = [];\n\n//     document.onkeydown = (event) => {\n//       const { keyCode } = event;\n//       let idx = this.keyCodeArray.indexOf(keyCode);\n\n//       if (idx === -1) {\n//         this.keyCodeArray.push(keyCode);\n//       }\n//     }\n\n//     document.onkeyup = (event) => {\n//       const { keyCode } = event;\n//       let idx = this.keyCodeArray.indexOf(keyCode);\n//       if (idx > -1) {\n//         this.keyCodeArray.splice(idx, 1);\n//       }\n//     }\n//   }\n\n//   getAxis (direction) {\n    \n//   }\n// }\n\nexport default Input\n","class Vertices {\n  constructor (x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n\nexport default Vertices\n","class Projection {\n  constructor (min, max) {\n    if (min > max) {\n      throw 'min value should less than max value';\n    }\n    this.min = min;\n    this.max = max;\n  }\n\n  overlaps (projection) {\n    // return this.max > projection.min && projection.max > this.min;\n  }\n}\n\nexport default Projection\n","let SAT = {};\n\nSAT.detectCollide = (shapeA, shapeB) => {\n  return !SAT.separationOnAxes(shapeA, shapeB);\n}\n\nSAT.separationOnAxes = (shapeA, shapeB) => {\n  let axes = shapeA.getAxes().concat(shapeB.getAxes());\n\n  for (let i = 0; i < axes.length; i++) {\n    let axis = axes[i];\n    let projection1 = shapeA.project(axis);\n    let projection2 = shapeB.project(axis);\n    if (!projection1.overlaps(projection2)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default SAT\n","import SAT from '../collision/SAT';\n\nclass Shape {\n  constructor (opts) {\n    opts = opts || {};\n    this.transform = {\n      position: {}\n    };\n    this.fillStyle = opts.fill || '#83cbff';\n    this.strokeWidth = opts.strokeWidth || 0;\n    this.strokeStyle = opts.stroke || 'grey';\n  }\n\n  collidesWith (otherShape) {\n    return SAT.detectCollide(this, otherShape);\n  }\n\n  getAxes () {\n    throw 'getAxes() not implemented';\n  }\n\n  project () {\n    throw 'project(axis) not implemented';\n  }\n\n  move () {\n    throw 'move(dx, dy) note implemented';\n  }\n}\n\nexport default Shape\n","class Vector {\n  constructor (x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  magnitude () {\n    return Math.sqrt(Math.pow(this.x, 2) + Math.pow(this.y, 2));\n  }\n\n  add (vector) {\n    let v = new Vector();\n    v.x = this.x + vector.x;\n    v.y = this.y + vector.y;\n    return v;\n  }\n\n  /**\n   * Subtracts another vector.\n   * @method sub\n   * @param {vector} vector\n   * @return {vector} A new vector of two vector subtracted\n   */\n  sub (vector) {\n    let v = new Vector();\n    v.x = this.x - vector.x;\n    v.y = this.y - vector.y;\n    return v;\n  }\n\n  dot (vector) {\n    return this.x * vector.x + this.y * vector.y;\n  }\n\n  edge (vector) {\n    return this.sub(vector);\n  }\n\n  /**\n   * Returns the perpendicular vector. Set `negate` to true for the perpendicular in the opposite direction.\n   * @method perp\n   * @param {vector} vector\n   * @param {bool} [negate=false]\n   * @return {vector} The perpendicular vector\n   */\n  perp (negate) {\n    negate = negate === true ? -1 : 1;\n    let v = new Vector();\n    v.x = negate * -this.y;\n    v.y = negate * this.x;\n    return v;\n  }\n\n  normalize () {\n    let v = new Vector(0, 0), m = this.magnitude();\n\n    if (m !== 0) {\n      v.x = this.x / m;\n      v.y = this.y / m;\n    }\n    return v;\n  }\n\n  normal () {\n    let p = this.perp();\n    return p.normalize();\n  }\n}\n\nexport default Vector","import Point from '../geometry/Vertices';\nimport Projection from '../geometry/Projection';\nimport Shape from './Shape';\nimport Vector from '../geometry/Vector';\nimport Vertices from '../geometry/Vertices';\n\nclass Polygon extends Shape {\n  constructor (points, opts) {\n    super(opts);\n    this.type = 'polygon';\n    this.vertices = points.map(point => new Vertices(point[0], point[1]));\n  }\n\n  getAxes () {\n    const { x: posX, y: posY } = this.transform.position;\n\n    let v1 = new Vector(),\n      v2 = new Vector(),\n      axes = [],\n      pointNum = this.vertices.length;\n\n  \n    for (let i = 0; i < pointNum - 1; i++) {\n      v1.x = this.vertices[i].x + posX;\n      v1.y = this.vertices[i].y + posY;\n\n      v2.x = this.vertices[i + 1].x + posX;\n      v2.y = this.vertices[i + 1].y + posY;\n\n      axes.push(v1.edge(v2).normal());\n    }\n\n    v1.x = this.vertices[pointNum - 1].x + posX;\n    v1.y = this.vertices[pointNum - 1].y + posY;\n\n    v2.x = this.vertices[0].x + posX;\n    v2.y = this.vertices[0].y + posY;\n    \n    axes.push(v1.edge(v2).normal());\n\n    return axes;\n  }\n\n  project (axis) {\n    const { x: posX, y: posY } = this.transform.position;\n\n    let scalars = [],\n      v = new Vector();\n\n    this.vertices.forEach(point => {\n      v.x = point.x + posX;\n      v.y = point.y + posY;\n      scalars.push(v.dot(axis));\n    })\n\n    return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n  }\n\n  addPoint (x, y) {\n    this.vertices.push(new Point(x, y));\n  }\n\n  move (dx, dy) {\n    for (let i = 0, point; i < this.vertices.length; i++) {\n      point = this.vertices[i];\n      point.x += dx;\n      point.y += dy;\n    }\n  }\n}\n\nexport default Polygon;\n","import Shape from './Shape';\n\nclass Cirlce extends Shape {\n  constructor (radius, opts) {\n    super(opts);\n    this.type = 'circle';\n    this.radius = radius;\n  }\n\n  getAxes () {\n  }\n\n  project (axis) {\n  }\n\n  addPoint (x, y) {\n  }\n\n  move (dx, dy) {\n  }\n}\n\nexport default Cirlce;","import Shape from './Shape';\n\nclass Rectangle extends Shape {\n  constructor (width, height, opts) {\n    super(opts);\n    this.type = 'rectangle';\n    this.width = width;\n    this.height = height;\n  }\n\n  getAxes () {\n  }\n\n  project (axis) {\n  }\n\n  addPoint (x, y) {\n  }\n\n  move (dx, dy) {\n  }\n}\n\nexport default Rectangle;","/*global ENV*/\nimport Engine from './core/Engine';\nimport Object from './core/Object';\nimport Input from './core/Input';\nimport Time from './core/Time';\nimport Polygon from './shape/Polygon';\nimport Circle from './shape/Circle';\nimport Rectangle from './shape/Rectangle';\n\n// Enable LiveReload\nif (ENV !== 'production') {\n  document.write(\n    '<script src=\"http://' + (location.host || 'localhost').split(':')[0] +\n    ':35729/livereload.js?snipver=1\"></' + 'script>'\n  )\n}\n\nconst myGame = Engine.create(document.getElementById('stage'), {\n  width: 600,\n  height: 300,\n  showFPS: true\n});\nconst startBtn = document.getElementById('start');\nconst stopBtn = document.getElementById('stop');\nconst pauseBtn = document.getElementById('pause');\nconst fastBtn = document.getElementById('fastward');\n\nlet player = new Object({\n  shape: new Polygon([\n    [0, 0],\n    [60, 0],\n    [60, 20],\n    [30, 40],\n    [10, 40]\n  ], {\n    fill: '#009688'\n  }),\n  transform: {\n    position: {\n      x: 230,\n      y: 150\n    }\n  },\n  start: function () {\n  },\n  update: function () {\n    let { transform } = this;\n\n    const horizontalInput = Input.getAxis('horizontal');\n    const verticalInput = Input.getAxis('vertical');\n    const speed = 100;\n\n    transform.position.x += speed * Time.deltaTime * horizontalInput;\n    transform.position.y += speed * Time.deltaTime * verticalInput;\n\n    if (this.shape.collidesWith(obstacle1.shape)) {\n      console.log('collide!!');\n    }\n  }\n});\n\nlet obstacle1 = new Object({\n  shape: new Rectangle(600, 20),\n  transform: {\n    position: {\n      x: 0,\n      y: 270\n    }\n  },\n  start: function () {\n  },\n  update: function () {\n  }\n});\n\nlet obstacle2 = new Object({\n  shape: new Circle(20, {\n    fill: '#ffc107'\n  }),\n  transform: {\n    position: {\n      x: 100,\n      y: 50\n    }\n  },\n  start: function () {\n  },\n  update: function () {\n    // let { transform } = this;\n\n    // const speed = 100;\n    // transform.position.x += speed * Time.deltaTime;\n  }\n});\n\nmyGame.scene.addObject(player);\nmyGame.scene.addObject(obstacle1);\nmyGame.scene.addObject(obstacle2);\n\nmyGame.render.render();\nmyGame.start();\n\nstartBtn.addEventListener('click', () => {\n  myGame.restart();\n})\n\nstopBtn.addEventListener('click', () => {\n  myGame.stop();\n})\n\npauseBtn.addEventListener('click', () => {\n  if (myGame.status === 'paused') {\n    myGame.resume();\n  } else {\n    myGame.pause();\n  }\n})\n\nfastBtn.addEventListener('click', () => {\n  myGame.Time.timeScale = 1.5;\n})\n\nconsole.log(myGame)\n"],"names":["Camera","create","game","camera","position","x","y","offset","scale","lookAt","isDragging","lastMousePosition","mouse","on","subPos","addPos","render","clear","context","translate","mousedownPosition","deltaScale","wheelDelta","follow","posA","posB","STARTING_FPS","Time","timeScale","unscaledDeltaTime","deltaTime","reset","timeStart","timePassed","fps","update","timeStamp","Mouse","element","absolute","mouseupPosition","button","pixelRatio","parseInt","getAttribute","sourceEvents","mousemove","mouseout","mousedown","mouseup","mousewheel","eventHooks","eventName","callback","triggerHook","call","event","_getRelativeMousePosition","touches","changedTouches","preventDefault","Math","max","min","detail","setElement","addEventListener","setOffset","setScale","elementBounds","getBoundingClientRect","rootNode","document","documentElement","body","parentNode","scrollX","window","pageXOffset","undefined","scrollLeft","scrollY","pageYOffset","scrollTop","pageX","left","pageY","top","clientWidth","width","clientHeight","height","Scene","scene","objectArray","addObject","object","push","forEach","status","updateCb","Render","el","opts","console","log","bgColor","canvas","createElement","_getPixelRatio","setAttribute","style","backgroundColor","append","getContext","clearRect","shapeType","shape","type","renderPolygon","renderRectangle","renderCircle","renderFPS","devicePixelRatio","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","font","fillStyle","fillText","toFixed","transform","posX","posY","beginPath","moveTo","vertices","i","length","lineTo","closePath","draw","rect","arc","radius","PI","lineWidth","strokeWidth","strokeStyle","stroke","fill","_reqFrame","_cancelFrame","_frameTimeout","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","oRequestAnimationFrame","self","start","finish","setTimeout","Date","timeout","cancelAnimationFrame","mozCancelAnimationFrame","clearTimeout","Engine","showFPS","PAUSE_TIMEOUT","run","restart","pause","resume","stop","frameReq","tick","isFunction","obj","Object","startCb","transform0","JSON","parse","stringify","rectW","rectH","fillRect","Input","keyCodeArray","onkeydown","keyCode","idx","indexOf","onkeyup","splice","getAxis","direction","Vertices","Projection","projection","SAT","detectCollide","shapeA","shapeB","separationOnAxes","axes","getAxes","concat","axis","projection1","project","projection2","overlaps","Shape","otherShape","Vector","sqrt","pow","vector","v","sub","negate","m","magnitude","p","perp","normalize","Polygon","points","map","point","v1","v2","pointNum","edge","normal","scalars","dot","apply","Point","dx","dy","Cirlce","Rectangle","write","location","host","split","myGame","getElementById","startBtn","stopBtn","pauseBtn","fastBtn","player","horizontalInput","verticalInput","speed","collidesWith","obstacle1","obstacle2","Circle"],"mappings":"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"}